<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŸƒåŠ å°¼ç¾…æ²³å¥³åœ˜</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fff7ed;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background-color: #fcd34d; border-radius: 10px; }

        .phrase-card:active { transform: scale(0.98); }
        .itinerary-card { transition: all 0.2s; }
        .itinerary-card:active { transform: scale(0.99); }

        /* Hide scrollbar for tab container */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ==============================
        // 1. éœæ…‹è³‡æ–™å®šç¾©
        // ==============================
        
        const keywordEmojis = {
            'ç«é‹': 'ğŸ²', 'æ™šé¤': 'ğŸ½ï¸', 'åˆé¤': 'ğŸ¥ª', 'æ—©åˆé¤': 'ğŸ³', 'åƒé£¯': 'ğŸ´', 'è€é­š': 'ğŸŸ', 'ç”¨é¤': 'ğŸ½ï¸',
            'é£›æ©Ÿ': 'âœˆï¸', 'èˆªç­': 'âœˆï¸', 'æ©Ÿå ´': 'ğŸ›«', 'T1': 'âœˆï¸', 'T2': 'âœˆï¸', 'T3': 'âœˆï¸',
            'è·¯å…‹ç´¢': 'ğŸ›•', 
            'åšç‰©é¤¨': 'ğŸ›ï¸', 'ç¥æ®¿': 'ğŸ›ï¸', 'ç¥å»Ÿ': 'ğŸ›ï¸', 'é‡‘å­—å¡”': 'ğŸ”º',
            'å¸‚é›†': 'ğŸ›ï¸', 'è³¼ç‰©': 'ğŸ›ï¸',
            'ä½å®¿': 'ğŸ¨', 'é£¯åº—': 'ğŸ¨', 'Hotel': 'ğŸ¨', 'Resort': 'ğŸ–ï¸', 'å…¥ä½': 'ğŸ¨',
            'ç†±æ°£çƒ': 'ğŸˆ', 'é¢¨å¸†èˆ¹': 'â›µ', 'æ­èˆ¹': 'â›µ',
            'æ²™æ¼ ': 'ğŸŒµ', 'è¡æ²™': 'ğŸš™', 'é§±é§': 'ğŸª',
            'æ½›æ°´': 'ğŸ¤¿', 'æµ®æ½›': 'ğŸ¤¿', 'æµ·': 'ğŸŒŠ', 'æ·±æ½›': 'ğŸ¤¿',
            'è¥¿å¥ˆå±±': 'â›°ï¸', 'ç™»å±±': 'ğŸ¥¾',
            'é–‹ç¾…': 'ğŸ™ï¸', 'è€åŸ': 'ğŸ•Œ', 'æ¸…çœŸå¯º': 'ğŸ•Œ'
        };

        const arabicPhrases = [
            { category: "æ‰“æ‹›å‘¼", meaning: "ä½ å¥½", original: "Salam Alaikum", phonetic: "è–©æ‹‰å§† é˜¿èŠåº«å§†" },
            { category: "ç¦®è²Œ", meaning: "è¬è¬", original: "Shukran", phonetic: "ä¼‘å…‹è˜­" },
            { category: "ç¦®è²Œ", meaning: "ä¸å®¢æ°£", original: "Afwan", phonetic: "é˜¿å¤«è¬" },
            { category: "ç¦®è²Œ", meaning: "æ˜¯ / å°", original: "Aywa", phonetic: "è‰¾ç“¦" },
            { category: "ç¦®è²Œ", meaning: "ä¸", original: "La", phonetic: "æ‹‰" },
            { category: "ç¦®è²Œ", meaning: "ä¸å¥½æ„æ€", original: "Ma'lish", phonetic: "ç½µåŠ›è¨±" },
            { category: "ç¦®è²Œ", meaning: "å†è¦‹", original: "Ma'a salama", phonetic: "ç‘ªè–©æ‹‰ç‘ª" },
            { category: "æ®ºåƒ¹", meaning: "å¤šå°‘éŒ¢ï¼Ÿ", original: "Bekam?", phonetic: "ç•¢å¡å§†ï¼Ÿ" },
            { category: "æ®ºåƒ¹", meaning: "å¤ªè²´äº†ï¼", original: "Ghali awi", phonetic: "åŠ åˆ© é˜¿ç¶­" },
            { category: "æ®ºåƒ¹", meaning: "ç®—ä¾¿å®œä¸€é»ï¼Ÿ", original: "Rakhees showaya?", phonetic: "æ‹‰å¥‡æ–¯ èˆ’å¨äºï¼Ÿ" },
            { category: "æ®ºåƒ¹", meaning: "æˆ‘ä¸è¦", original: "La Shukran", phonetic: "æ‹‰ ä¼‘å…‹è˜­" },
            { category: "æ®ºåƒ¹", meaning: "èµ°é–‹", original: "Imshi", phonetic: "éŸ³è¨±ï¼" },
            { category: "æ®ºåƒ¹", meaning: "å¤ äº†", original: "Khalas", phonetic: "å“ˆæ‹‰æ–¯" },
            { category: "ç”Ÿæ´»", meaning: "æ°´", original: "Mayya", phonetic: "ç‘ªé›…" },
            { category: "ç”Ÿæ´»", meaning: "å»æ‰€", original: "Hamam", phonetic: "å“ˆåª½åª½" },
            { category: "ç”Ÿæ´»", meaning: "è¶•å¿« / èµ°äº†", original: "Yalla", phonetic: "é›…æ‹‰" },
            { category: "ç”Ÿæ´»", meaning: "è­¦å¯Ÿ", original: "Bolice", phonetic: "æ³¢åˆ©æ–¯" }
        ];

        const arabicNumbers = [
            { num: "0", arabNum: "Ù ", phonetic: "å¸Œå¤«çˆ¾" },
            { num: "1", arabNum: "Ù¡", phonetic: "ç“¦é»‘å¾·" },
            { num: "2", arabNum: "Ù¢", phonetic: "è€¶ç‰¹å¯§" },
            { num: "3", arabNum: "Ù£", phonetic: "å¡”æ‹‰å¡”" },
            { num: "4", arabNum: "Ù¤", phonetic: "é˜¿çˆ¾å·´" },
            { num: "5", arabNum: "Ù¥", phonetic: "æ­æ’’" },
            { num: "6", arabNum: "Ù¦", phonetic: "å¡å¡”" },
            { num: "7", arabNum: "Ù§", phonetic: "è–©å·´" },
            { num: "8", arabNum: "Ù¨", phonetic: "å¡”æ›¼äº" },
            { num: "9", arabNum: "Ù©", phonetic: "éµè–©" },
            { num: "10", arabNum: "Ù¡Ù ", phonetic: "é˜¿æ²™æ‹‰" },
            { num: "50", arabNum: "Ù¥Ù ", phonetic: "æ­ä¿¡" },
            { num: "100", arabNum: "Ù¡Ù Ù ", phonetic: "æ¢…äº" }
        ];

        const initialItineraryData = [
            // 12/12
            { day: "12/12", location: "æ¾å±±", mapUrl: "https://www.google.com/maps/search/?api=1&query=å°åŒ—æ¾å±±æ©Ÿå ´", activity: "18:05 å°åŒ—æ¾å±±æ©Ÿå ´ T1 å ±åˆ°", notes: "èˆªç­ 3U3982", timestamp: Date.parse("2025-12-12T18:05:00") },
            { day: "12/12", location: "æˆéƒ½å¤©åºœåœ‹éš›æ©Ÿå ´ T1", mapUrl: "https://www.google.com/maps/search/?api=1&query=æˆéƒ½å¤©åºœåœ‹éš›æ©Ÿå ´", activity: "21:45 æŠµé”æˆéƒ½", notes: "è½‰æ©Ÿç­‰å€™", timestamp: Date.parse("2025-12-12T21:45:00") },
            { day: "12/12", location: "æ±éƒ¨èœ€éŸ»ç«é‹(å¤©åºœæ©Ÿå ´æ——è‰¦åº—)", mapUrl: "https://www.google.com/maps/search/?api=1&query=æ±éƒ¨èœ€éŸ»ç«é‹+å¤©åºœæ©Ÿå ´", activity: "22:30 å®µå¤œ/ç”¨é¤", notes: "é£æœºåˆ°è¾¾å æ‰¾åˆ°T2çš„22å·é—¨/T1çš„13å·é—¨ï¼Œç­‰å¸æœºæ¥æ¥å°±è¡Œå•¦ã€‚", timestamp: Date.parse("2025-12-12T22:30:00") }, 
            // 12/13
            { day: "12/13", location: "æˆéƒ½å¤©åºœåœ‹éš›æ©Ÿå ´ T1", mapUrl: "https://www.google.com/maps/search/?api=1&query=æˆéƒ½å¤©åºœåœ‹éš›æ©Ÿå ´", activity: "01:45 è½‰æ©Ÿ/å‡ºç™¼", notes: "èˆªç­ 3U3863", timestamp: Date.parse("2025-12-13T01:45:00") },
            { day: "12/13", location: "é–‹ç¾…åœ‹éš›æ©Ÿå ´ T2", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cairo+International+Airport+Terminal+2", activity: "06:45 æŠµé”é–‹ç¾…", notes: "å…¥å¢ƒèˆ‡æµ·é—œ", timestamp: Date.parse("2025-12-13T06:45:00") },
            { day: "12/13", location: "Seyid Efendi Hotel", mapUrl: "https://www.google.com/maps/search/?api=1&query=Seyid+Efendi+Hotel+Cairo", activity: "08:00 å…¥ä½/æ”¾è¡Œæ", notes: "æˆ¿è²» US$125.99", timestamp: Date.parse("2025-12-13T08:00:00") },
            { day: "12/13", location: "OLDISH", mapUrl: "https://maps.app.goo.gl/3Wr6svtHCe17wKug9", activity: "08:30 æ—©åˆé¤", notes: "", timestamp: Date.parse("2025-12-13T08:30:00") },
            { day: "12/13", location: "é–‹ç¾…è€åŸ (é›†åˆé»: KFC Tahrir)", mapUrl: "https://www.google.com/maps/search/?api=1&query=KFC+Tahrir+Square", activity: "09:30 Free Walking Tour", notes: "é›†åˆé»: KFC Tahrir square å‰", timestamp: Date.parse("2025-12-13T09:30:00") },
            { day: "12/13", location: "Zamalek City Walk", mapUrl: "https://www.google.com/maps/search/?api=1&query=Zamalek+Cairo", activity: "14:00 åŸå¸‚æ¼«æ­¥", notes: "", timestamp: Date.parse("2025-12-13T14:00:00") },
            { day: "12/13", location: "Ibn Hamido Seafood / Saheb El Sa'ada", mapUrl: "https://www.google.com/maps/search/?api=1&query=Ibn+Hamido+Seafood+Cairo", activity: "18:00 æ™šé¤", notes: "", timestamp: Date.parse("2025-12-13T18:00:00") },
            // 12/14
            { day: "12/14", location: "Spire West Hotel", mapUrl: "https://www.google.com/maps/search/?api=1&query=Spire+West+Hotel+Cairo", activity: "10:00 å»Spire West Hotel æœƒåˆ", notes: "", timestamp: Date.parse("2025-12-14T10:00:00") },
            { day: "12/14", location: "Spire West Hotel", mapUrl: "https://www.google.com/maps/search/?api=1&query=Spire+West+Hotel+Cairo", activity: "11:00 ä½å®¿: Spire West Hotel", notes: "", timestamp: Date.parse("2025-12-14T11:00:00") },
            { day: "12/14", location: "åˆé¤", mapUrl: "", activity: "12:00 åˆé¤", notes: "", timestamp: Date.parse("2025-12-14T12:00:00") },
            { day: "12/14", location: "å¤§åŸƒåŠåšç‰©é¤¨", mapUrl: "https://www.google.com/maps/search/?api=1&query=Grand+Egyptian+Museum", activity: "14:00 åˆå¾Œåƒè§€å¤§åŸƒåŠåšç‰©é¤¨", notes: "", timestamp: Date.parse("2025-12-14T14:00:00") },
            { day: "12/14", location: "MUZZI å¤§è¡—", mapUrl: "https://www.google.com/maps/search/?api=1&query=Al+Muizz+Street+Cairo", activity: "16:30 æ¼«æ­¥ MUZZI å¤§è¡—æ„Ÿå—åŸƒåŠè€åŸ", notes: "", timestamp: Date.parse("2025-12-14T16:30:00") },
            { day: "12/14", location: "å“ˆåˆ©åˆ©å¸‚é›†", mapUrl: "https://www.google.com/maps/search/?api=1&query=Khan+el-Khalili", activity: "18:00 å“ˆåˆ©åˆ©å¸‚é›†", notes: "", timestamp: Date.parse("2025-12-14T18:00:00") },
            // 12/15
            { day: "12/15", location: "å‰è–©é‡‘å­—å¡”ç¾¤ & äººé¢ç…èº«åƒ", mapUrl: "https://www.google.com/maps/search/?api=1&query=Giza+Necropolis", activity: "07:30 å‡ºç™¼åƒè§€é‡‘å­—å¡”", notes: "", timestamp: Date.parse("2025-12-15T07:30:00") },
            { day: "12/15", location: "å‰å¾€æ©Ÿå ´ (é£›å¾€ç›§å…‹ç´¢)", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cairo+International+Airport", activity: "12:30 å‰å¾€æ©Ÿå ´", notes: "é è¨ˆé€› 3.5 å°æ™‚å¾Œ å‡ºç™¼", timestamp: Date.parse("2025-12-15T12:30:00") },
            { day: "12/15", location: "ç›§å…‹ç´¢æ©Ÿå ´/é¢¨å¸†èˆ¹", mapUrl: "https://www.google.com/maps/search/?api=1&query=Luxor+International+Airport", activity: "17:15 æŠµé”ç›§å…‹ç´¢", notes: "å¦‚è¶•ä¸Šæ—¥è½å¯æ­ä¹˜é¢¨å¸†èˆ¹ã€‚", timestamp: Date.parse("2025-12-15T17:15:00") },
            { day: "12/15", location: "Iberotal Luxor", mapUrl: "https://www.google.com/maps/search/?api=1&query=Iberotel+Luxor", activity: "19:00 æ™šé¤/ä½å®¿", notes: "", timestamp: Date.parse("2025-12-15T19:00:00") },
            { day: "12/15", location: "è·¯å…‹ç´¢ç¥æ®¿", mapUrl: "https://www.google.com/maps/search/?api=1&query=Luxor+Temple", activity: "20:00 æ™šé£¯å¾Œè‡ªç”±æ´»å‹•", notes: "å¯è‡ªç”±é¸æ“‡å‰å¾€ã€‚å”¯ã‡å¤œé–“æœ‰æ‰“ç‡ˆå…‰ç§€ï¼Œå¯åœ¨å¤–é¢æ‹ç…§ä¸æœƒæ”¶é–€ç¥¨è²»ã€‚", timestamp: Date.parse("2025-12-15T20:00:00") },
            // 12/16
            { day: "12/16", location: "ç†±æ°£çƒ (è¥¿å²¸/å¸ç‹è°·/å“ˆå¸ƒåŸ)", mapUrl: "https://www.google.com/maps/search/?api=1&query=Valley+of+the+Kings", activity: "04:30 ç†±æ°£çƒ", notes: "ä¹˜åç†±æ°£çƒ(è‡ªè²» 60$)ï¼ŒçµæŸå¾Œåƒè§€æ›¼å„‚é›•åƒã€å¸ç‹è°·ã€å“ˆå¸ƒåŸã€‚", timestamp: Date.parse("2025-12-16T04:30:00") },
            { day: "12/16", location: "å¡ç´å…‹ç¥å»Ÿ Temple of Karnak", mapUrl: "https://www.google.com/maps/search/?api=1&query=Karnak+Temple", activity: "12:00 å›æ±å²¸ç¹¼çºŒåƒè§€", notes: "åƒè§€å¡ç´å…‹ç¥å»Ÿ", timestamp: Date.parse("2025-12-16T12:00:00") },
            { day: "12/16", location: "é˜¿æ–¯æ—º (Aswan)", mapUrl: "https://www.google.com/maps/search/?api=1&query=Aswan", activity: "14:00 åˆé¤å¾Œå‰å¾€é˜¿æ–¯æ—º", notes: "è»Šç¨‹ç´„ 4~4.5 å°æ™‚", timestamp: Date.parse("2025-12-16T14:00:00") },
            { day: "12/16", location: "HAPI HOTEL", mapUrl: "https://www.google.com/maps/search/?api=1&query=Hapi+Hotel+Aswan", activity: "18:30 ä½å®¿: HAPI HOTEL (æš«å®š)", notes: "", timestamp: Date.parse("2025-12-16T18:30:00") },
            // 12/17
            { day: "12/17", location: "é˜¿å¸ƒè¾›è²ç¥æ®¿", mapUrl: "https://www.google.com/maps/search/?api=1&query=Abu+Simbel+Temples", activity: "03:00 å‡ºç™¼è‡³é˜¿å¸ƒè¾›è²ç¥æ®¿", notes: "è»Šç¨‹ç´„ 4~4.5 å°æ™‚ã€‚åƒè§€å®Œç•¢å¾Œè¿”å›é˜¿æ–¯æ—ºåƒåˆé¤ã€‚", timestamp: Date.parse("2025-12-17T03:00:00") },
            { day: "12/17", location: "è²èŠç¥å»Ÿ", mapUrl: "https://www.google.com/maps/search/?api=1&query=Philae+Temple", activity: "14:00 åƒè§€è²èŠç¥å»Ÿ", notes: "å°¼ç¾…æ²³ä¸Šçš„åŸƒåŠçç ã€‚å¦‚ 12/15 æ²’é‡ä¸Šæ—¥è½ï¼Œå¯æ–¼ä»Šå¤©è£œé¢¨å¸†èˆ¹ã€‚", timestamp: Date.parse("2025-12-17T14:00:00") },
            { day: "12/17", location: "Sayed Effendi Boutique Hotel", mapUrl: "https://www.google.com/maps/search/?api=1&query=Seyid+Efendi+Hotel+Cairo", activity: "20:00 æ™šé¤å¾Œé£›è¿”é–‹ç¾…", notes: "ä½å®¿: Sayed Effendi Boutique Hotel", timestamp: Date.parse("2025-12-17T20:00:00") },
            // 12/18
            { day: "12/18", location: "Almaza Airport", mapUrl: "https://www.google.com/maps/search/?api=1&query=Almaza+Air+Base", activity: "07:00 å‡ºç™¼è‡³è»ç”¨æ©Ÿå ´ Almaza Airport", notes: "æ­ä¹˜ 9:00 am è»æ©Ÿå‰å¾€éŒ«ç“¦(SIWA)ã€‚è»æ©Ÿè¡Œæé™é‡: 20å…¬æ–¤ã€‚", timestamp: Date.parse("2025-12-18T07:00:00") },
            { day: "12/18", location: "Siwa Oasis / æ²™åˆ©å ¡å£˜", mapUrl: "https://www.google.com/maps/search/?api=1&query=Shali+Fortress+Siwa", activity: "10:30 æŠµé” Siwa Oasis / åƒè§€æ²™åˆ©å ¡å£˜", notes: "åˆºå®¢æ•™æ¢æ‹æ”åœ°ã€‚å…¥ä½ Cafour House Siwa / Hot springã€‚", timestamp: Date.parse("2025-12-18T10:30:00") },
            { day: "12/18", location: "Cleopatraâ€™s Spring", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cleopatra+Spring+Siwa", activity: "14:00 ä¸‹åˆåƒè§€ Cleopatraâ€™s Spring", notes: "ä¸­é¤(ABDU)ã€é€›é€›å¸‚é›†ã€‚å™´æ³‰è¡Œç¨‹è«‹æ”œå¸¶æ³³è¡£ã€‚", timestamp: Date.parse("2025-12-18T14:00:00") },
            { day: "12/18", location: "Fetnas å³¶", mapUrl: "https://www.google.com/maps/search/?api=1&query=Fatnas+Island+Siwa", activity: "17:00 å‰å¾€ Fetnas å³¶çœ‹æ—¥è½", notes: "çµæŸå¾Œåœ¨æ°‘å®¿åƒæ™šé¤", timestamp: Date.parse("2025-12-18T17:00:00") },
            // 12/19
            { day: "12/19", location: "é˜¿è’™ç¥è«­ç¥æ®¿ / å¤¢å¹»é¹½æ¹–", mapUrl: "https://www.google.com/maps/search/?api=1&query=Temple+of+the+Oracle+of+Amun", activity: "09:00 åƒè§€ç¥æ®¿èˆ‡å¤è€å¢“ç©´ã€é¹½æ¹–", notes: "ä¸­åˆè¿”å›å¸‚å€åƒä¸­é¤(ABDU æˆ–å…¶ä»–)ã€‚é¹½æ¹–ä¸‹æ°´æ‹ç…§è£å‚™åŠæ¯›å·¾ï¼Œè¡æ²™å»ºè­°ç©¿è¤²è£ã€‚", timestamp: Date.parse("2025-12-19T09:00:00") },
            { day: "12/19", location: "éŒ«ç“¦æ²™æ¼ ", mapUrl: "https://www.google.com/maps/search/?api=1&query=Siwa+Oasis", activity: "14:00 æ²™æ¼ è¡æ²™ã€æ»‘æ²™ã€å¤•é™½", notes: "è¶Šé‡è»Šè¡æ²™ã€è¡æµªæ¿æ»‘æ²™ã€æ²™ä¸˜æ¬£è³å¤•é™½ã€‚æ™šä¸Šåœ¨æ²™æ¼ ç¯ç«åƒæ™šé¤(çƒ¤é›)ã€‚", timestamp: Date.parse("2025-12-19T14:00:00") },
            { day: "12/19", location: "å¤œå·´ (å¾€é–‹ç¾…)", mapUrl: "", activity: "22:00 æ­å¤œå·´å›é–‹ç¾…", notes: "çµæŸå¾Œè¿”å›æ°‘å®¿æ´—æ¾¡ä¸¦å‰å¾€æ­å¤œå·´ã€‚æ™šä¸Šåé»é–‹åˆ°æ—©ä¸Šåé»åˆ°é–‹ç¾…ã€‚", timestamp: Date.parse("2025-12-19T22:00:00") },
            // 12/20
            { day: "12/20", location: "é–‹ç¾…", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cairo", activity: "09:00 æŠµé”é–‹ç¾…æ©Ÿå ´", notes: "", timestamp: Date.parse("2025-12-20T09:00:00") },
            { day: "12/20", location: "æ²™å§†æ²™ä¼Šèµ« (Sharm El Sheikh)", mapUrl: "https://www.google.com/maps/search/?api=1&query=Sharm+El-Sheikh+International+Airport", activity: "13:45 æŠµé”æ²™å§†æ²™ä¼Šèµ«", notes: "æ­ä¹˜ä¸­åˆçš„ç­æ©Ÿã€‚å…¥ä½ Sunrise Diamond Beach Resort (ä¸‰é¤é£²æ–™å…¨åŒ…)ã€‚", timestamp: Date.parse("2025-12-20T13:45:00") },
            { day: "12/20", location: "Farsha Mountain Lounge", mapUrl: "https://www.google.com/maps/search/?api=1&query=Farsha+Cafe", activity: "16:00 Farsha æ‡¸å´–é…’å§åƒé£¯", notes: "å“¡æ—…è´ŠåŠ©é¤ã€‚æ™šä¸Šå‰å¾€ç•¶åœ°å®¶æ¨‚ç¦æˆ–å¸‚é›†æ¡è²·é€›è¡—ã€‚", timestamp: Date.parse("2025-12-20T16:00:00") },
            // 12/21
            { day: "12/21", location: "Ras Mohammed Reserve", mapUrl: "https://www.google.com/maps/search/?api=1&query=Ras+Mohammed+National+Park", activity: "07:50 æ·±æ½› pick up", notes: "deep diving swimming,lunch,drinks,Ras Mohammed Reserve", timestamp: Date.parse("2025-12-21T07:50:00") },
            { day: "12/21", location: "Ras Mohammed Reserve", mapUrl: "https://www.google.com/maps/search/?api=1&query=Ras+Mohammed+National+Park", activity: "16:30 è¿”å›", notes: "", timestamp: Date.parse("2025-12-21T16:30:00") },
            { day: "12/21", location: "è¥¿å¥ˆå±± (Mt. Sinai)", mapUrl: "https://www.google.com/maps/search/?api=1&query=Mount+Sinai", activity: "20:00 æ™šä¸Šè‡ªè²»è¡Œç¨‹: è¥¿å¥ˆå±±ç™»å±±", notes: "20:00 å‡ºç™¼ï¼Œ02:30 æŠµé”ç™»å±±å£ã€‚ç™»å±± 3 å°æ™‚ï¼Œ05:00 çœ‹æ—¥å‡ºã€‚ä¸‹å±±åƒè§€è–æ¯ä¿®é“é™¢ï¼Œé è¨ˆéš”æ—¥ä¸‹åˆ 14:00 æŠµé”æ²™å§†ã€‚", timestamp: Date.parse("2025-12-21T20:00:00") },
            // 12/22
            { day: "12/22", location: "Sunrise Diamond Beach Resort", mapUrl: "https://www.google.com/maps/search/?api=1&query=Sunrise+Diamond+Beach+Resort", activity: "09:00 æ—©ä¸Šäº«ç”¨é£¯åº—è¨­æ–½", notes: "", timestamp: Date.parse("2025-12-22T09:00:00") },
            { day: "12/22", location: "å‰å¾€æ©Ÿå ´", mapUrl: "https://www.google.com/maps/search/?api=1&query=Sharm+El-Sheikh+International+Airport", activity: "18:30 é£›å¾€é–‹ç¾…", notes: "å‰å¾€æ²™å§†æ²™ä¼Šèµ«æ©Ÿå ´", timestamp: Date.parse("2025-12-22T18:30:00") },
            { day: "12/22", location: "Logistics-5-stars", mapUrl: "https://www.google.com/maps/search/?api=1&query=Logistics-5-stars+Cairo", activity: "21:00 ä½å®¿: Logistics-5-stars", notes: "", timestamp: Date.parse("2025-12-22T21:00:00") },
            // 12/23
            { day: "12/23", location: "é–‹ç¾…åœ‹éš›æ©Ÿå ´ T2", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cairo+International+Airport+Terminal+2", activity: "13:55 é–‹ç¾…é–‹ç¾…åœ‹éš›æ©Ÿå ´ T2 EY714", notes: "", timestamp: Date.parse("2025-12-23T13:55:00") },
            { day: "12/23", location: "é˜¿å¸ƒæ‰æ¯”åœ‹éš›æ©Ÿå ´ A", mapUrl: "https://www.google.com/maps/search/?api=1&query=Zayed+International+Airport+Terminal+A", activity: "19:15 é˜¿å¸ƒé”æ¯”é˜¿å¸ƒæ‰æ¯”åœ‹éš›æ©Ÿå ´ A", notes: "", timestamp: Date.parse("2025-12-23T19:15:00") },
            { day: "12/23", location: "é˜¿å¸ƒæ‰æ¯”åœ‹éš›æ©Ÿå ´ A", mapUrl: "https://www.google.com/maps/search/?api=1&query=Zayed+International+Airport+Terminal+A", activity: "21:25 é˜¿å¸ƒé”æ¯”é˜¿å¸ƒæ‰æ¯”åœ‹éš›æ©Ÿå ´ A EY898", notes: "", timestamp: Date.parse("2025-12-23T21:25:00") },
            // 12/24
            { day: "12/24", location: "å°ç£æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ T2", mapUrl: "https://www.google.com/maps/search/?api=1&query=Taiwan+Taoyuan+International+Airport+Terminal+2", activity: "09:00 å°ç£æ¡ƒåœ’å°ç£æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ T2", notes: "", timestamp: Date.parse("2025-12-24T09:00:00") },
        ];

        const initialPacking = [
            { group: "é‡è¦ç‰©å“", text: "è­·ç…§åŠä¿¡ç”¨å¡", checked: false },
            { group: "é‡è¦ç‰©å“", text: "å°èƒè­‰", checked: false }, 
            { group: "é‡è¦ç‰©å“", text: "ç¾é‡‘ (å¦å‚™ä¹¾æ·¨ç„¡æ‘ºç—•25ç¾é‡‘ç”³è«‹ç°½è­‰)", checked: false },
            { group: "é‡è¦ç‰©å“", text: "2å‹ç™½åº•ç…§ç‰‡*2å¼µ", checked: false },
            { group: "é‡è¦ç‰©å“", text: "æ­è¦æ’é ­è½‰æ›å™¨ã€é›»å£“è½‰æ›å™¨", checked: false },
            { group: "é›»å­ç”¨å“", text: "æ‰‹æ©Ÿå……é›»ç·š", checked: false },
            { group: "é›»å­ç”¨å“", text: "å–å¡é‡", checked: false },
            { group: "é›»å­ç”¨å“", text: "è¡Œå‹•é›»æºã€è€³æ©Ÿ", checked: false },
            { group: "é›»å­ç”¨å“", text: "éš¨èº«å°é¢¨æ‰‡ (éå……é›»å¼è«‹è¨˜å¾—æ”œå¸¶é›»æ± )", checked: false },
            { group: "è—¥å“", text: "éæ•è—¥ã€æšˆè»Š/èˆ¹è—¥ã€è–„è·æ²¹", checked: false },
            { group: "è—¥å“", text: "èƒƒè—¥ã€æ­¢ç€‰è—¥ã€æ„Ÿå†’è—¥", checked: false },
            { group: "è—¥å“", text: "å€‹äººå¸¸ç”¨è—¥/ä¿å¥é£Ÿå“", checked: false },
            { group: "è—¥å“", text: "çœ¼è—¥æ°´", checked: false },
            { group: "å€‹äººç‰©å“", text: "Uå‹é ¸æ• (è»Šç¨‹é•·æœƒéœ€è¦)", checked: false },
            { group: "å€‹äººç‰©å“", text: "ç‰™è†ã€ç‰™åˆ·ã€æ¢³å­ (é£¯åº—ä¸æä¾›)", checked: false },
            { group: "å€‹äººç‰©å“", text: "ä¿é¤Šå“ã€é¢è†œã€æ´—è­·é«®åŠå¸å¦ç”¨å“", checked: false },
            { group: "å€‹äººç‰©å“", text: "å¥½èµ°çš„é‹ã€æ¶¼é‹ã€æ‹–é‹ (é£¯åº—é€šå¸¸ä¸æä¾›)", checked: false },
            { group: "å€‹äººç‰©å“", text: "æ³³è¡£ã€é˜²æ°´è¢‹ã€æµ®æ½›ç”¨å…· (ä¾å€‹äººéœ€æ±‚)", checked: false },
            { group: "å€‹äººç‰©å“", text: "å€‹äººè¡£ç‰©(å¥—*å¤©æ•¸)ã€å¤–å¥—ã€åœå·¾ã€æ‰‹å¥—", checked: false },
            { group: "å€‹äººç‰©å“", text: "æ¿•ç´™å·¾ã€é¢ç´™", checked: false },
            { group: "å€‹äººç‰©å“", text: "å‰éš†å¡ç¶²å¡E-SIM", checked: false }, 
            { group: "å€‹äººç‰©å“", text: "é˜²æ›¬è¡£ç‰©ã€å¢¨é¡ã€é®é™½å¸½/å‚˜ã€å£ç½©", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "å…æ´—å…§è¡£è¤²", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "æ‹‹æ£„å¼æ•é ­å¥—ã€æ¯›å·¾", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "æ‹‹æ£„å¼é¦¬æ¡¶åå¢Š", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "æ´—è‡‰å·¾", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "å¹é¢¨æ©Ÿ", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "ç†±æ°´ç“¶ã€é›»å­é‹ (åœ‹éš›é›»å£“)", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "ç³§é£Ÿã€æ³¡éºµ(ç¢—)-é¿å…åŒ…è£ä¸Šæœ‰ã€Œè±¬è‚‰ã€åœ–æ¡ˆ", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "å…æ´—é¤å…·", checked: false },
            { group: "é¡å¤–å»ºè­°", text: "æ‰‹æ©Ÿæ›ç¹©", checked: false }
        ];

        // ==============================
        // 2. React Component (ä¸»ç¨‹å¼)
        // ==============================

        const App = () => {
            const [view, setView] = useState('itinerary');
            const [packingList, setPackingList] = useState([]);
            const [expandedDays, setExpandedDays] = useState({});
            
            // åˆå§‹åŒ–ï¼šå¾ LocalStorage è®€å– (æ‰‹æ©Ÿä¸Šæœƒå­˜ä½)
            useEffect(() => {
                const savedList = localStorage.getItem('egypt_packing_offline_v10');
                if (savedList) {
                    setPackingList(JSON.parse(savedList));
                } else {
                    // ç”¢ç”Ÿå…¨æ–°çš„ç‰©ä»¶é™£åˆ—
                    setPackingList(initialPacking.map(item => ({...item})));
                }
            }, []);

            const togglePackingItem = (index) => {
                setPackingList(prevList => {
                    // ä½¿ç”¨ map å‰µå»ºæ–°é™£åˆ—ï¼Œç¢ºä¿ React åµæ¸¬åˆ°è®Šæ›´ä¸¦è§¸ç™¼é‡ç¹ª
                    const newList = prevList.map((item, i) => 
                        i === index ? { ...item, checked: !item.checked } : item
                    );
                    localStorage.setItem('egypt_packing_offline_v10', JSON.stringify(newList));
                    return newList;
                });
            };
            
            const resetData = () => {
                if(!confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰å‹¾é¸ç‹€æ…‹å—ï¼Ÿ")) return;
                // å¾åŸå§‹è³‡æ–™ç”¢ç”Ÿä¸€ä»½å…¨æ–°çš„æ¸…å–®
                const freshList = initialPacking.map(item => ({...item, checked: false}));
                setPackingList(freshList);
                localStorage.setItem('egypt_packing_offline_v10', JSON.stringify(freshList));
                alert("å·²é‡ç½®ï¼");
            };

            const toggleDay = (day) => {
                setExpandedDays(prev => ({
                    ...prev,
                    [day]: !prev[day]
                }));
            };

            // Helper functions for render
            const getSummaryText = (items) => {
                 const summaryItems = items.filter(item => {
                    const loc = item.location.toLowerCase();
                    const act = item.activity.toLowerCase();
                    
                    // æ’é™¤ä½å®¿
                    if (loc.includes('hotel') || loc.includes('resort') || loc.includes('ä½å®¿') || loc.includes('å…¥ä½')) {
                         if (items.length > 2) return false;
                    }
                    // æ’é™¤ç´”ç”¨é¤
                    if ((loc === 'åˆé¤' || loc === 'æ™šé¤' || act === 'åˆé¤' || act === 'æ™šé¤')) {
                         if (!loc.includes('å‰å¾€') && !act.includes('å‰å¾€')) return false;
                    }
                    // æ’é™¤æ©Ÿå ´ç§»å‹• (12/15 éœ€æ±‚)
                    if (loc.includes('å‰å¾€æ©Ÿå ´') || act.includes('å‰å¾€æ©Ÿå ´') || act.includes('é£›å¾€') || act.includes('æ­ä¹˜')) return false;

                    return true;
                });

                return summaryItems.map(i => {
                    let name = i.location;
                    for (const [key, emoji] of Object.entries(keywordEmojis)) {
                        if (name.includes(key) || i.activity.includes(key)) {
                            if (!name.includes(emoji)) name = emoji + ' ' + name;
                            break; 
                        }
                    }
                    return name.replace(/\(.*\)/, '').replace(/ï¼ˆ.*ï¼‰/, '').trim(); 
                }).join(' â” ');
            };

            window.switchView = setView;

            // Group Itinerary
            const groupedItinerary = initialItineraryData.reduce((acc, item) => {
                (acc[item.day] = acc[item.day] || []).push(item);
                return acc;
            }, {});

            // Group Packing
            const groupedPacking = packingList.reduce((acc, item) => {
                 (acc[item.group] = acc[item.group] || []).push(item);
                 return acc;
            }, {});

            return (
                <div className="pb-24">
                     {/* Sticky Header */}
                     <div className="sticky top-0 z-50 bg-[#fff7ed]">
                        <div className="bg-white/90 backdrop-blur-md shadow-sm p-4 mb-4 rounded-b-2xl border-b border-amber-100">
                            <h1 className="text-2xl font-bold text-center text-amber-800 tracking-tight mb-1">ğŸª åŸƒåŠ å°¼ç¾…æ²³å¥³åœ˜</h1>
                            <p className="text-center text-amber-600/70 text-xs mb-3">12/12 - 12/24</p>
                            
                            {/* Navigation Tabs */}
                            <div className="flex justify-center space-x-2 no-scrollbar overflow-x-auto">
                                <button 
                                    onClick={() => setView('itinerary')} 
                                    className={`tab-button ${view === 'itinerary' ? 'tab-active' : 'tab-inactive'}`}>
                                    ğŸ“… è¡Œç¨‹ç¸½è¦½
                                </button>
                                <button 
                                    onClick={() => setView('packing')} 
                                    className={`tab-button ${view === 'packing' ? 'tab-active' : 'tab-inactive'}`}>
                                    ğŸ’ è¡Œææ¸…å–®
                                </button>
                                <button 
                                    onClick={() => setView('arabic')} 
                                    className={`tab-button ${view === 'arabic' ? 'tab-active' : 'tab-inactive'}`}>
                                    ğŸ—£ï¸ ç©ºè€³é˜¿æ‹‰ä¼¯èª
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-2xl mx-auto px-4">
                        {/* ITINERARY VIEW */}
                        {view === 'itinerary' && (
                             <div className="space-y-4">
                                {Object.entries(groupedItinerary).map(([day, items]) => {
                                    const summaryText = getSummaryText(items);
                                    const isExpanded = expandedDays[day];
                                    
                                    // åªæœ‰ç´”æ•¸å­—æ—¥æœŸ
                                    let dateNum = day.split('/')[1];
                                    if(!dateNum) dateNum = "";

                                    return (
                                        <div key={day} className="mb-4 bg-white rounded-xl shadow-sm border-l-4 border-amber-400 overflow-hidden itinerary-card">
                                            <div className="p-4 cursor-pointer bg-white hover:bg-amber-50 transition-colors flex flex-col"
                                                 onClick={() => toggleDay(day)}>
                                                <div className="flex justify-between items-center mb-1">
                                                    <div className="flex items-center">
                                                        <span className="text-lg font-extrabold text-amber-900 leading-none mr-2">{day}</span>
                                                    </div>
                                                    <span className={`text-xl font-bold w-8 h-8 flex items-center justify-center rounded-full transition-colors ${isExpanded ? 'text-white bg-amber-400' : 'text-amber-400 bg-amber-50'}`}>
                                                        {isExpanded ? 'â€“' : '+'}
                                                    </span>
                                                </div>
                                                <span className="text-xs font-medium text-gray-500 leading-relaxed block w-full break-words pl-1 border-l-2 border-gray-100 ml-1">
                                                    {summaryText}
                                                </span>
                                            </div>
                                            
                                            {isExpanded && (
                                                <div className="px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 bg-gray-50/50 item-details visible-details">
                                                    {items.map((item, idx) => (
                                                        <div key={idx} className="flex flex-col bg-white p-3 rounded-lg shadow-sm border border-gray-100">
                                                            <div className="flex justify-between items-start">
                                                                <div className="flex-1">
                                                                    <p className="text-lg font-bold text-gray-800 mb-1">{item.activity}</p>
                                                                    {item.mapUrl ? (
                                                                        <a href={item.mapUrl} target="_blank" className="text-sm text-amber-600 hover:text-amber-800 hover:underline flex items-center gap-1 font-medium">
                                                                            ğŸ“ {item.location}
                                                                        </a>
                                                                    ) : (
                                                                        <span className="text-sm text-gray-500 flex items-center gap-1">ğŸ“ {item.location}</span>
                                                                    )}
                                                                </div>
                                                            </div>
                                                            {item.notes && <div className="mt-2 text-xs text-gray-500 bg-gray-50 p-2 rounded border border-gray-100">{item.notes}</div>}
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    )
                                })}
                             </div>
                        )}

                        {/* PACKING LIST VIEW */}
                        {view === 'packing' && (
                            <div className="space-y-4 animate-fade-in">
                                {Object.entries(groupedPacking).map(([group, items]) => (
                                    <div key={group} className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                        <h3 className="bg-amber-50 px-4 py-2 text-sm font-bold text-amber-800 border-b border-amber-100">
                                            ğŸ’ {group}
                                        </h3>
                                        <div className="divide-y divide-gray-50">
                                            {items.map((item) => {
                                                // Find correct index in main list using direct comparison
                                                const originalIndex = packingList.findIndex(p => p.group === item.group && p.text === item.text);
                                                return (
                                                    <div key={item.text + originalIndex} 
                                                         onClick={() => togglePackingItem(originalIndex)}
                                                         className="flex items-center p-3 hover:bg-gray-50 cursor-pointer transition-colors">
                                                        <div className={`w-5 h-5 rounded border flex items-center justify-center mr-3 flex-shrink-0 ${item.checked ? 'bg-amber-500 border-amber-500 text-white' : 'border-gray-300'}`}>
                                                            {item.checked && 'âœ“'}
                                                        </div>
                                                        <span className={`text-sm ${item.checked ? 'text-gray-400 line-through' : 'text-gray-700'}`}>
                                                            {item.text}
                                                        </span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                                <div className="text-center pt-4 pb-8">
                                    <button onClick={resetData} className="text-sm text-gray-500 underline hover:text-amber-600">é‡ç½®æ‰€æœ‰å‹¾é¸</button>
                                </div>
                            </div>
                        )}

                        {/* ARABIC VIEW */}
                        {view === 'arabic' && (
                             <div className="space-y-6 animate-fade-in">
                                 <div>
                                    <h3 className="text-lg font-bold text-amber-800 mb-3 flex items-center"><span className="bg-amber-100 p-1 rounded mr-2">ğŸ”¢</span> æ•¸å­—å°ç…§</h3>
                                    <div className="grid grid-cols-3 sm:grid-cols-4 gap-3">
                                        {arabicNumbers.map((n, i) => (
                                            <div key={i} className="bg-white p-2 rounded-lg shadow-sm border border-gray-100 text-center flex flex-col items-center justify-center h-20 phrase-card">
                                                <div className="text-lg font-bold text-gray-400 leading-none">{n.num}</div>
                                                <div className="text-2xl font-bold text-amber-600 font-serif leading-none my-1">{n.arabNum}</div>
                                                <div className="text-xs text-gray-500 bg-gray-50 px-2 rounded-full">{n.phonetic}</div>
                                            </div>
                                        ))}
                                    </div>
                                 </div>
                                 <hr className="border-amber-200/50"/>
                                 <div>
                                    <h3 className="text-lg font-bold text-amber-800 mb-3 flex items-center"><span className="bg-amber-100 p-1 rounded mr-2">ğŸ‡ªğŸ‡¬</span> ç”Ÿæ´»ç”¨èª</h3>
                                    <div className="grid grid-cols-1 gap-3">
                                         {arabicPhrases.map((p, i) => (
                                            <div key={i} className="bg-white p-3 rounded-lg shadow-sm border-l-4 border-amber-400 flex justify-between items-center phrase-card">
                                                <div>
                                                    <div className="text-xs text-amber-600 font-bold mb-0.5">{p.category}</div>
                                                    <div className="text-base font-bold text-gray-800">{p.phonetic}</div>
                                                    <div className="text-xs text-gray-400">{p.original}</div>
                                                </div>
                                                <div className="text-sm font-bold text-amber-700 bg-amber-50 px-2 py-1 rounded">
                                                    {p.meaning}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                 </div>
                             </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>